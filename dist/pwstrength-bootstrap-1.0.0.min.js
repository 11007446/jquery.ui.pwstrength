/* pwstrength-bootstrap 2013-12-25 */

!function(a){"use strict";var b,c,d={},e={},f={},g={},h={};d.forbiddenSequences=["0123456789","9876543210","abcdefghijklmnopqrstuvxywz","qwertyuiop","asdfghjkl","zxcvbnm"],e.wordNotEmail=function(a,b,c){return b.match(/^([\w\!\#$\%\&\'\*\+\-\/\=\?\^\`{\|\}\~]+\.)*[\w\!\#$\%\&\'\*\+\-\/\=\?\^\`{\|\}\~]+@((((([a-z0-9]{1}[a-z0-9\-]{0,62}[a-z0-9]{1})|[a-z])\.)+[a-z]{2,6})|(\d{1,3}\.){3}\d{1,3}(\:\d{1,5})?)$/i)?(a.instances.errors.push(a.ui.spanError(a,"email_as_password")),c):void 0},e.wordLength=function(a,b,c){var d=b.length,e=Math.pow(d,a.rules.raisePower);return d<a.common.minChar&&(e+=c,a.instances.errors.push(a.ui.spanError(a,"password_too_short"))),e},e.wordSimilarToUsername=function(b,c,d){var e=a(b.common.usernameField).val();return e&&c.toLowerCase().match(e.toLowerCase())?(b.instances.errors.push(b.ui.spanError(b,"same_as_username")),d):!1},e.wordTwoCharacterClasses=function(a,b,c){return b.match(/([a-z].*[A-Z])|([A-Z].*[a-z])/)||b.match(/([a-zA-Z])/)&&b.match(/([0-9])/)||b.match(/(.[!,@,#,$,%,\^,&,*,?,_,~])/)&&b.match(/[a-zA-Z0-9_]/)?c:(a.instances.errors.push(a.ui.spanError(a,"two_character_classes")),!1)},e.wordRepetitions=function(a,b,c){return b.match(/(.)\1\1/)?(a.instances.errors.push(a.ui.spanError(a,"repeated_character")),c):!1},e.wordSequences=function(b,c,e){var f,g=!1;return c.length>2&&(a.each(d.forbiddenSequences,function(a,b){for(f=0;f<c.length-3;f+=1)b.indexOf(c.toLowerCase().substring(f,f+3))>-1&&(g=!0)}),g)?(b.instances.errors.push(b.ui.spanError(b,"sequence_found")),e):!1},e.wordLowercase=function(a,b,c){return b.match(/[a-z]/)&&c},e.wordUppercase=function(a,b,c){return b.match(/[A-Z]/)&&c},e.wordOneNumber=function(a,b,c){return b.match(/\d+/)&&c},e.wordThreeNumbers=function(a,b,c){return b.match(/(.*[0-9].*[0-9].*[0-9])/)&&c},e.wordOneSpecialChar=function(a,b,c){return b.match(/.[!,@,#,$,%,\^,&,*,?,_,~]/)&&c},e.wordTwoSpecialChar=function(a,b,c){return b.match(/(.*[!,@,#,$,%,\^,&,*,?,_,~].*[!,@,#,$,%,\^,&,*,?,_,~])/)&&c},e.wordUpperLowerCombo=function(a,b,c){return b.match(/([a-z].*[A-Z])|([A-Z].*[a-z])/)&&c},e.wordLetterNumberCombo=function(a,b,c){return b.match(/([a-zA-Z])/)&&b.match(/([0-9])/)&&c},e.wordLetterNumberCharCombo=function(a,b,c){return b.match(/([a-zA-Z0-9].*[!,@,#,$,%,\^,&,*,?,_,~])|([!,@,#,$,%,\^,&,*,?,_,~].*[a-zA-Z0-9])/)&&c},d.validation=e,d.executeRules=function(b,c){var e=0;return a.each(b.rules.activated,function(f,g){if(g){var h,i=b.rules.scores[f],j=d.validation[f];a.isFunction(j)||(j=b.rules.extra[f]),a.isFunction(j)&&(h=j(b,c,i),h&&(e+=h))}}),e},f.common={},f.common.minChar=6,f.common.usernameField="#username",f.common.onLoad=void 0,f.common.onKeyUp=void 0,f.rules={},f.rules.extra={},f.rules.scores={wordNotEmail:-100,wordLength:-50,wordSimilarToUsername:-100,wordSequences:-50,wordTwoCharacterClasses:2,wordRepetitions:-25,wordLowercase:1,wordUppercase:3,wordOneNumber:3,wordThreeNumbers:5,wordOneSpecialChar:3,wordTwoSpecialChar:5,wordUpperLowerCombo:2,wordLetterNumberCombo:2,wordLetterNumberCharCombo:2},f.rules.activated={wordNotEmail:!0,wordLength:!0,wordSimilarToUsername:!0,wordSequences:!0,wordTwoCharacterClasses:!1,wordRepetitions:!1,wordLowercase:!0,wordUppercase:!0,wordOneNumber:!0,wordThreeNumbers:!0,wordOneSpecialChar:!0,wordTwoSpecialChar:!0,wordUpperLowerCombo:!0,wordLetterNumberCombo:!0,wordLetterNumberCharCombo:!0},f.rules.raisePower=1.4,f.ui={},f.ui.bootstrap2=!1,f.ui.showPopover=!1,f.ui.spanError=function(a,b){var c=a.ui.errorMessages[b];return'<span style="color: #d52929">'+c+"</span>"},f.ui.errorMessages={password_too_short:"The Password is too short",email_as_password:"Do not use your email as your password",same_as_username:"Your password cannot contain your username",two_character_classes:"Use different character classes",repeated_character:"Too many repetitions",sequence_found:"Your password contains sequences"},f.ui.verdicts=["Weak","Normal","Medium","Strong","Very Strong"],f.ui.showVerdicts=!0,f.ui.showErrors=!1,f.ui.container=void 0,f.ui.viewports={progress:void 0,verdict:void 0,errors:void 0},f.ui.scores=[14,26,38,50],g.getContainer=function(b,c){var d;return d=a(b.ui.container),d&&1===d.length||(d=c.parent()),d},g.findElement=function(a,b,c){return b?a.find(b).find(c):a.find(c)},g.getUIElements=function(a,b){var c,d;return a.instances.viewports?a.instances.viewports:(d={},c=g.getContainer(a,b),d.$progressbar=g.findElement(c,a.ui.viewports.progress,"div.progress"),a.ui.showPopover||(d.$verdict=g.findElement(c,a.ui.viewports.verdict,"span.password-verdict"),d.$errors=g.findElement(c,a.ui.viewports.errors,"ul.error-list")),a.instances.viewports=d,d)},g.initProgressBar=function(b,c){var d=g.getContainer(b,c),e="<div class='progress'><div class='";b.ui.bootstrap2||(e+="progress-"),e+="bar'></div></div>",b.ui.viewports.progress?d.find(b.ui.viewports.progress).append(e):a(e).insertAfter(c)},g.initHelper=function(b,c,d,e){var f=g.getContainer(b,c);e?f.find(e).append(d):a(d).insertAfter(c)},g.initVerdict=function(a,b){g.initHelper(a,b,"<span class='password-verdict'></span>",a.ui.viewports.verdict)},g.initErrorList=function(a,b){g.initHelper(a,b,"<ul class='error-list'></ul>",a.ui.viewports.errors)},g.initPopover=function(b,c,d){var e="auto top",f="";b.ui.bootstrap2&&(e="top"),b.ui.showVerdicts&&d.length>0&&(f="<h5><span class='password-verdict'>"+d+"</span></h5>"),b.ui.showErrors&&(f+="<div><ul class='error-list'>",a.each(b.instances.errors,function(a,b){f+="<li>"+b+"</li>"}),f+="</ul></div>"),c.popover("destroy"),c.popover({html:!0,placement:e,trigger:"manual",content:f}),c.popover("show")},g.initUI=function(a,b){a.ui.showPopover||(g.initErrorList(a,b),g.initVerdict(a,b)),g.initProgressBar(a,b)},g.possibleProgressBarClasses=["danger","warning","success"],g.updateProgressBar=function(b,c,d,e){var f=g.getUIElements(b,c).$progressbar,h=f.find(".progress-bar"),i="progress-";b.ui.bootstrap2&&(h=f.find(".bar"),i=""),a.each(g.possibleProgressBarClasses,function(a,b){h.removeClass(i+"bar-"+b)}),h.addClass(i+"bar-"+d),h.css("width",e+"%")},g.updateVerdict=function(a,b,c){var d=g.getUIElements(a,b).$verdict;d.text(c)},g.updateErrors=function(b,c){var d=g.getUIElements(b,c).$errors,e="";a.each(b.instances.errors,function(a,b){e+="<li>"+b+"</li>"}),d.html(e)},g.percentage=function(a,b){var c=Math.floor(100*a/b);return c=0>c?0:c,c=c>100?100:c},g.updateUI=function(a,b,c){var d,e,f;e=g.percentage(c,a.ui.scores[3]),0>=c?(d="danger",f=""):c<a.ui.scores[0]?(d="danger",f=a.ui.verdicts[0]):c<a.ui.scores[1]?(d="danger",f=a.ui.verdicts[1]):c<a.ui.scores[2]?(d="warning",f=a.ui.verdicts[2]):c<a.ui.scores[3]?(d="warning",f=a.ui.verdicts[3]):(d="success",f=a.ui.verdicts[4]),g.updateProgressBar(a,b,d,e),a.ui.showPopover?g.initPopover(a,b,f):(a.ui.showVerdicts&&g.updateVerdict(a,b,f),a.ui.showErrors&&g.updateErrors(a,b))},b=function(b){var c,e=a(b.target),f=e.data("pwstrength-bootstrap"),h=e.val();f.instances.errors=[],c=d.executeRules(f,h),g.updateUI(f,e,c),a.isFunction(f.common.onKeyUp)&&f.common.onKeyUp(b)},h.init=function(c){return this.each(function(d,e){var h=a.extend(!0,{},f),i=a.extend(!0,h,c),j=a(e);i.instances={},j.data("pwstrength-bootstrap",i),j.on("keyup",b),g.initUI(i,j),a.isFunction(i.common.onLoad)&&i.common.onLoad()}),this},h.destroy=function(){this.each(function(b,c){var d=a(c),e=d.data("pwstrength-bootstrap"),f=g.getUIElements(e,d);f.$progressbar.remove(),f.$verdict.remove(),f.$errors.remove(),d.removeData("pwstrength-bootstrap")})},h.forceUpdate=function(){this.each(function(a,c){var d={target:c};b(d)})},h.addRule=function(b,c,d,e){this.each(function(f,g){var h=a(g).data("pwstrength-bootstrap");h.rules.activated[b]=e,h.rules.scores[b]=d,h.rules.extra[b]=c})},c=function(b,c,d){this.each(function(e,f){a(f).data("pwstrength-bootstrap").rules[c][b]=d})},h.changeScore=function(a,b){c.call(this,a,"scores",b)},h.ruleActive=function(a,b){c.call(this,a,"activated",b)},a.fn.pwstrength=function(b){var c;return h[b]?c=h[b].apply(this,Array.prototype.slice.call(arguments,1)):"object"!=typeof b&&b?a.error("Method "+b+" does not exist on jQuery.pwstrength-bootstrap"):c=h.init.apply(this,arguments),c}}(jQuery);
//# sourceMappingURL=pwstrength-bootstrap-1.0.0.min.map