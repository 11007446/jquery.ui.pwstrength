/* pwstrength-bootstrap 2013-12-28 - GPLv3 & MIT License */

!function(a){"use strict";var b,c,d={exports:""},e={},f={},g={},h={};if(!a&&d&&d.exports)var a=require("jquery");!function(a,b){var c={};a.forbiddenSequences=["0123456789","9876543210","abcdefghijklmnopqrstuvxywz","qwertyuiop","asdfghjkl","zxcvbnm"],c.wordNotEmail=function(a,b,c){return b.match(/^([\w\!\#$\%\&\'\*\+\-\/\=\?\^\`{\|\}\~]+\.)*[\w\!\#$\%\&\'\*\+\-\/\=\?\^\`{\|\}\~]+@((((([a-z0-9]{1}[a-z0-9\-]{0,62}[a-z0-9]{1})|[a-z])\.)+[a-z]{2,6})|(\d{1,3}\.){3}\d{1,3}(\:\d{1,5})?)$/i)?(a.instances.errors.push(a.ui.spanError(a,"email_as_password")),c):void 0},c.wordLength=function(a,b,c){var d=b.length,e=Math.pow(d,a.rules.raisePower);return d<a.common.minChar&&(e+=c,a.instances.errors.push(a.ui.spanError(a,"password_too_short"))),e},c.wordSimilarToUsername=function(a,c,d){var e=b(a.common.usernameField).val();return e&&c.toLowerCase().match(e.toLowerCase())?(a.instances.errors.push(a.ui.spanError(a,"same_as_username")),d):!1},c.wordTwoCharacterClasses=function(a,b,c){return b.match(/([a-z].*[A-Z])|([A-Z].*[a-z])/)||b.match(/([a-zA-Z])/)&&b.match(/([0-9])/)||b.match(/(.[!,@,#,$,%,\^,&,*,?,_,~])/)&&b.match(/[a-zA-Z0-9_]/)?c:(a.instances.errors.push(a.ui.spanError(a,"two_character_classes")),!1)},c.wordRepetitions=function(a,b,c){return b.match(/(.)\1\1/)?(a.instances.errors.push(a.ui.spanError(a,"repeated_character")),c):!1},c.wordSequences=function(c,d,e){var f,g=!1;return d.length>2&&(b.each(a.forbiddenSequences,function(a,b){for(f=0;f<d.length-3;f+=1)b.indexOf(d.toLowerCase().substring(f,f+3))>-1&&(g=!0)}),g)?(c.instances.errors.push(c.ui.spanError(c,"sequence_found")),e):!1},c.wordLowercase=function(a,b,c){return b.match(/[a-z]/)&&c},c.wordUppercase=function(a,b,c){return b.match(/[A-Z]/)&&c},c.wordOneNumber=function(a,b,c){return b.match(/\d+/)&&c},c.wordThreeNumbers=function(a,b,c){return b.match(/(.*[0-9].*[0-9].*[0-9])/)&&c},c.wordOneSpecialChar=function(a,b,c){return b.match(/.[!,@,#,$,%,\^,&,*,?,_,~]/)&&c},c.wordTwoSpecialChar=function(a,b,c){return b.match(/(.*[!,@,#,$,%,\^,&,*,?,_,~].*[!,@,#,$,%,\^,&,*,?,_,~])/)&&c},c.wordUpperLowerCombo=function(a,b,c){return b.match(/([a-z].*[A-Z])|([A-Z].*[a-z])/)&&c},c.wordLetterNumberCombo=function(a,b,c){return b.match(/([a-zA-Z])/)&&b.match(/([0-9])/)&&c},c.wordLetterNumberCharCombo=function(a,b,c){return b.match(/([a-zA-Z0-9].*[!,@,#,$,%,\^,&,*,?,_,~])|([!,@,#,$,%,\^,&,*,?,_,~].*[a-zA-Z0-9])/)&&c},a.validation=c,a.executeRules=function(c,d){var e=0;return b.each(c.rules.activated,function(f,g){if(g){var h,i=c.rules.scores[f],j=a.validation[f];b.isFunction(j)||(j=c.rules.extra[f]),b.isFunction(j)&&(h=j(c,d,i),h&&(e+=h))}}),e}}(h,a),d.exports=h,e.common={},e.common.minChar=6,e.common.usernameField="#username",e.common.onLoad=void 0,e.common.onKeyUp=void 0,e.rules={},e.rules.extra={},e.rules.scores={wordNotEmail:-100,wordLength:-50,wordSimilarToUsername:-100,wordSequences:-50,wordTwoCharacterClasses:2,wordRepetitions:-25,wordLowercase:1,wordUppercase:3,wordOneNumber:3,wordThreeNumbers:5,wordOneSpecialChar:3,wordTwoSpecialChar:5,wordUpperLowerCombo:2,wordLetterNumberCombo:2,wordLetterNumberCharCombo:2},e.rules.activated={wordNotEmail:!0,wordLength:!0,wordSimilarToUsername:!0,wordSequences:!0,wordTwoCharacterClasses:!1,wordRepetitions:!1,wordLowercase:!0,wordUppercase:!0,wordOneNumber:!0,wordThreeNumbers:!0,wordOneSpecialChar:!0,wordTwoSpecialChar:!0,wordUpperLowerCombo:!0,wordLetterNumberCombo:!0,wordLetterNumberCharCombo:!0},e.rules.raisePower=1.4,e.ui={},e.ui.bootstrap2=!1,e.ui.showPopover=!1,e.ui.spanError=function(a,b){var c=a.ui.errorMessages[b];return'<span style="color: #d52929">'+c+"</span>"},e.ui.errorMessages={password_too_short:"The Password is too short",email_as_password:"Do not use your email as your password",same_as_username:"Your password cannot contain your username",two_character_classes:"Use different character classes",repeated_character:"Too many repetitions",sequence_found:"Your password contains sequences"},e.ui.verdicts=["Weak","Normal","Medium","Strong","Very Strong"],e.ui.showVerdicts=!0,e.ui.showErrors=!1,e.ui.container=void 0,e.ui.viewports={progress:void 0,verdict:void 0,errors:void 0},e.ui.scores=[14,26,38,50],f.getContainer=function(b,c){var d;return d=a(b.ui.container),d&&1===d.length||(d=c.parent()),d},f.findElement=function(a,b,c){return b?a.find(b).find(c):a.find(c)},f.getUIElements=function(a,b){var c,d;return a.instances.viewports?a.instances.viewports:(d={},c=f.getContainer(a,b),d.$progressbar=f.findElement(c,a.ui.viewports.progress,"div.progress"),a.ui.showPopover||(d.$verdict=f.findElement(c,a.ui.viewports.verdict,"span.password-verdict"),d.$errors=f.findElement(c,a.ui.viewports.errors,"ul.error-list")),a.instances.viewports=d,d)},f.initProgressBar=function(b,c){var d=f.getContainer(b,c),e="<div class='progress'><div class='";b.ui.bootstrap2||(e+="progress-"),e+="bar'></div></div>",b.ui.viewports.progress?d.find(b.ui.viewports.progress).append(e):a(e).insertAfter(c)},f.initHelper=function(b,c,d,e){var g=f.getContainer(b,c);e?g.find(e).append(d):a(d).insertAfter(c)},f.initVerdict=function(a,b){f.initHelper(a,b,"<span class='password-verdict'></span>",a.ui.viewports.verdict)},f.initErrorList=function(a,b){f.initHelper(a,b,"<ul class='error-list'></ul>",a.ui.viewports.errors)},f.initPopover=function(b,c,d){var e="auto top",f="";b.ui.bootstrap2&&(e="top"),b.ui.showVerdicts&&d.length>0&&(f="<h5><span class='password-verdict'>"+d+"</span></h5>"),b.ui.showErrors&&(f+="<div><ul class='error-list'>",a.each(b.instances.errors,function(a,b){f+="<li>"+b+"</li>"}),f+="</ul></div>"),c.popover("destroy"),c.popover({html:!0,placement:e,trigger:"manual",content:f}),c.popover("show")},f.initUI=function(a,b){a.ui.showPopover||(f.initErrorList(a,b),f.initVerdict(a,b)),f.initProgressBar(a,b)},f.possibleProgressBarClasses=["danger","warning","success"],f.updateProgressBar=function(b,c,d,e){var g=f.getUIElements(b,c).$progressbar,h=g.find(".progress-bar"),i="progress-";b.ui.bootstrap2&&(h=g.find(".bar"),i=""),a.each(f.possibleProgressBarClasses,function(a,b){h.removeClass(i+"bar-"+b)}),h.addClass(i+"bar-"+d),h.css("width",e+"%")},f.updateVerdict=function(a,b,c){var d=f.getUIElements(a,b).$verdict;d.text(c)},f.updateErrors=function(b,c){var d=f.getUIElements(b,c).$errors,e="";a.each(b.instances.errors,function(a,b){e+="<li>"+b+"</li>"}),d.html(e)},f.percentage=function(a,b){var c=Math.floor(100*a/b);return c=0>c?0:c,c=c>100?100:c},f.updateUI=function(a,b,c){var d,e,g;e=f.percentage(c,a.ui.scores[3]),0>=c?(d="danger",g=""):c<a.ui.scores[0]?(d="danger",g=a.ui.verdicts[0]):c<a.ui.scores[1]?(d="danger",g=a.ui.verdicts[1]):c<a.ui.scores[2]?(d="warning",g=a.ui.verdicts[2]):c<a.ui.scores[3]?(d="warning",g=a.ui.verdicts[3]):(d="success",g=a.ui.verdicts[4]),f.updateProgressBar(a,b,d,e),a.ui.showPopover?f.initPopover(a,b,g):(a.ui.showVerdicts&&f.updateVerdict(a,b,g),a.ui.showErrors&&f.updateErrors(a,b))},b=function(b){var c,d=a(b.target),e=d.data("pwstrength-bootstrap"),g=d.val();e.instances.errors=[],c=h.executeRules(e,g),f.updateUI(e,d,c),a.isFunction(e.common.onKeyUp)&&e.common.onKeyUp(b)},g.init=function(c){return this.each(function(d,g){var h=a.extend(!0,{},e),i=a.extend(!0,h,c),j=a(g);i.instances={},j.data("pwstrength-bootstrap",i),j.on("keyup",b),f.initUI(i,j),a.isFunction(i.common.onLoad)&&i.common.onLoad()}),this},g.destroy=function(){this.each(function(b,c){var d=a(c),e=d.data("pwstrength-bootstrap"),g=f.getUIElements(e,d);g.$progressbar.remove(),g.$verdict.remove(),g.$errors.remove(),d.removeData("pwstrength-bootstrap")})},g.forceUpdate=function(){this.each(function(a,c){var d={target:c};b(d)})},g.addRule=function(b,c,d,e){this.each(function(f,g){var h=a(g).data("pwstrength-bootstrap");h.rules.activated[b]=e,h.rules.scores[b]=d,h.rules.extra[b]=c})},c=function(b,c,d){this.each(function(e,f){a(f).data("pwstrength-bootstrap").rules[c][b]=d})},g.changeScore=function(a,b){c.call(this,a,"scores",b)},g.ruleActive=function(a,b){c.call(this,a,"activated",b)},a.fn.pwstrength=function(b){var c;return g[b]?c=g[b].apply(this,Array.prototype.slice.call(arguments,1)):"object"!=typeof b&&b?a.error("Method "+b+" does not exist on jQuery.pwstrength-bootstrap"):c=g.init.apply(this,arguments),c}}(jQuery);
//# sourceMappingURL=pwstrength-bootstrap-1.0.0.min.map